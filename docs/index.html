<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Geo-Red de Usuarios</title>
    
    <!-- Favicon simple -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üó∫Ô∏è</text></svg>">
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <link rel="stylesheet" href="styles.css">
</head>
<body>

    <header class="main-header">
        <div class="header-brand">
            <span class="logo-text">GeoRed</span>
        </div>
        <nav class="main-nav">
            <button id="btn-search-service" class="nav-btn nav-btn-search">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M18.031 16.617l4.283 4.282-1.415 1.415-4.282-4.283A8.96 8.96 0 0 1 11 20c-4.968 0-9-4.032-9-9s4.032-9 9-9 9 4.032 9 9a8.96 8.96 0 0 1-1.969 5.617zm-2.006-.742A6.977 6.977 0 0 0 18 11c0-3.868-3.133-7-7-7-3.868 0-7 3.132-7 7 0 3.867 3.132 7 7 7a6.977 6.977 0 0 0 4.875-1.975l.15-.15z"></path></svg>
                <span>Buscar</span>
            </button>
            <button id="btn-add-service" class="nav-btn">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M11 11V5h2v6h6v2h-6v6h-2v-6H5v-2h6z"></path></svg>
                <span>Publicar</span>
            </button>
            <button id="btn-profile-menu" class="nav-btn">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2c5.52 0 10 4.48 10 10s-4.48 10-10 10S2 17.52 2 12 6.48 2 12 2zm0 4c-1.93 0-3.5 1.57-3.5 3.5S10.07 13 12 13s3.5-1.57 3.5-3.5S13.93 6 12 6zm0 14c-2.03 0-4.43-.82-6.14-2.88a9.947 9.947 0 0 1 12.28 0C16.43 19.18 14.03 20 12 20z"></path></svg>
                <span>Iniciar Sesi√≥n</span>
            </button>
        </nav>
    </header>

    <main>
        <!-- Secci√≥n del Mapa (vista principal) -->
        <section id="map-section" class="active-section">
            <div id="map"></div>

            <!-- Hero overlay (mini-landing sobre el mapa) -->
            <div class="map-hero" role="region" aria-label="Introducci√≥n">
                <h1 class="hero-title">Encuentra servicios locales</h1>
                <p class="hero-subtitle">Publica tu oferta en 1 minuto</p>
                <div class="hero-ctas">
                    <button id="hero-explore" class="cta-btn">Explorar mapa</button>
                    <button id="hero-publish" class="cta-btn secondary">Publicar servicio</button>
                </div>
            </div>

            <div class="floating-controls">
                <button id="btn-current-location" class="control-btn" title="Mostrar tu ubicaci√≥n">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24" height="24">
                        <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
                    </svg>
                </button>
            </div>
        </section>

        <!-- Panel de B√∫squeda de Servicios -->
        <aside id="search-panel" class="search-panel">
            <div class="panel-content">
                <div class="panel-header">
                    <h2>Buscar servicios cerca de m√≠</h2>
                    <button id="close-search-panel" class="close-btn">&times;</button>
                </div>
                <div class="search-container">
                    <input type="text" id="service-search-input" placeholder="Buscar servicios..." class="search-input">
                    
                    <!-- Filtros Collapsibles -->
                    <div class="filters-section">
                        <button id="toggle-filters" class="filters-toggle">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
                            </svg>
                            <span>Filtros</span>
                            <span id="active-filters-count" class="filters-badge hidden">0</span>
                            <svg class="chevron" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </button>
                        
                        <div id="filters-content" class="filters-content">
                            <!-- Control de Radio de B√∫squeda -->
                            <div class="filter-group">
                                <div class="filter-header">
                                    <label class="filter-toggle-label">
                                        <input type="checkbox" id="enable-radius-filter" class="filter-checkbox">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <circle cx="12" cy="12" r="10"></circle>
                                            <circle cx="12" cy="12" r="3"></circle>
                                        </svg>
                                        <span>Limitar por distancia</span>
                                    </label>
                                </div>
                                <div id="radius-filter-content" class="filter-content disabled">
                                    <div class="radius-slider-container">
                                        <label for="search-radius" class="radius-label">
                                            Radio: <span id="radius-value">5</span> km
                                        </label>
                                        <input type="range" id="search-radius" min="1" max="50" value="5" step="1" class="radius-slider">
                                        <div class="radius-marks">
                                            <span>1 km</span>
                                            <span>10 km</span>
                                            <span>25 km</span>
                                            <span>50 km</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Categor√≠as -->
                            <div class="filter-group">
                                <div class="filter-header">
                                    <h4>Categor√≠as</h4>
                                </div>
                                <div id="filter-status" class="filter-status"></div>
                                <div id="service-categories" class="categories-grid"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="search-results" class="results-container">
                    <div id="results-count"></div>
                    <ul id="nearby-users-list"></ul>
                </div>
            </div>
        </aside>

        <!-- Panel de Publicar Servicio -->
        <aside id="publish-panel" class="search-panel">
            <div class="panel-content">
                <div class="panel-header">
                    <h2>Publicar un servicio</h2>
                    <button id="close-publish-panel" class="close-btn">&times;</button>
                </div>
                <form id="register-form" class="publish-form">
                    <!-- Secci√≥n de Categor√≠as (al inicio del formulario) -->
                    <div class="form-section category-section">
                        <h3 class="section-title">Categor√≠a del servicio</h3>
                        <p class="section-subtitle">Selecciona la categor√≠a que mejor describe tu servicio</p>
                        
                        <div class="modern-category-selector">
                            <div id="main-category-grid" class="category-grid"></div>
                        </div>
                        
                        <div id="subcategory-container" class="subcategory-container hidden">
                            <button type="button" id="back-to-categories" class="back-button">‚Üê Volver</button>
                            <div id="subcategory-grid" class="subcategory-grid"></div>
                        </div>
                        
                        <input type="hidden" id="service-main-category" required>
                        <input type="hidden" id="service-subcategory" required>
                        <div id="selected-category-display" class="selected-category-display hidden">
                            <span class="selected-icon">‚úì</span>
                            <span id="selected-category-text" class="selected-text"></span>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="service-name">Nombre del servicio:</label>
                        <input type="text" id="service-name" required placeholder="Ej: Reparaci√≥n de electrodom√©sticos">
                    </div>
                    <div class="form-group">
                        <label for="service-description">Descripci√≥n del servicio:</label>
                        <textarea id="service-description" required placeholder="Describe tu servicio en detalle..." rows="3"></textarea>
                    </div>
                    
                    <!-- Sistema de Precios Mejorado -->
                    <div class="form-group">
                        <label for="service-price">Precio:</label>
                        <div class="price-input-group">
                            <span class="currency-symbol">$</span>
                            <input type="number" id="service-price" required placeholder="15000" min="0" step="100">
                        </div>
                        <small class="form-hint">Ingresa solo el monto num√©rico (sin puntos ni comas)</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="price-modality">Modalidad de cobro:</label>
                        <select id="price-modality" required>
                            <option value="por_servicio" selected>Por servicio completo</option>
                            <option value="por_hora">Por hora</option>
                            <option value="por_dia">Por d√≠a</option>
                            <option value="por_mes">Por mes</option>
                            <option value="por_proyecto">Por proyecto</option>
                            <option value="consultar">A consultar</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="service-schedule">Horario de atenci√≥n:</label>
                        <select id="service-schedule" required>
                            <option value="">Selecciona un horario</option>
                            <option value="Lunes a Viernes">Lunes a Viernes</option>
                            <option value="Lunes a S√°bado">Lunes a S√°bado</option>
                            <option value="Lunes a Domingo">Lunes a Domingo</option>
                            <option value="24 horas">24 horas</option>
                            <option value="Solo festivos">Solo festivos</option>
                        </select>
                    </div>
                    
                    <!-- Secci√≥n de Contacto Mejorada -->
                    <div class="form-group">
                        <label>M√©todo de contacto preferido:</label>
                        <div class="contact-method-selector">
                            <label class="radio-button-option" for="contact-email">
                                <input type="radio" id="contact-email" name="contact-method" value="email" checked>
                                <span class="radio-button-content">üìß Email</span>
                            </label>
                            <label class="radio-button-option" for="contact-phone">
                                <input type="radio" id="contact-phone" name="contact-method" value="phone">
                                <span class="radio-button-content">üì± Tel√©fono m√≥vil</span>
                            </label>
                        </div>
                    </div>

                    <!-- Email Contact Section -->
                    <div id="email-contact-section" class="contact-section">
                        <div class="form-group">
                            <label for="user-email">Email de contacto:</label>
                            <input type="email" id="user-email" value="contacto@ejemplo.com" placeholder="tu-email@ejemplo.com">
                            <small class="form-hint">Este email ser√° visible solo para clientes interesados</small>
                        </div>
                    </div>

                    <!-- Phone Contact Section -->
                    <div id="phone-contact-section" class="contact-section hidden">
                        <div class="form-group">
                            <label for="user-phone">Tel√©fono m√≥vil:</label>
                            <input type="tel" id="user-phone" value="+56912345678" placeholder="+56912345678" maxlength="20">
                            <small class="form-hint">Incluye c√≥digo de pa√≠s. Ej: +56912345678, +34612345678</small>
                            <div id="phone-validation" class="validation-message"></div>
                        </div>
                        
                        <div class="form-group">
                            <label class="checkbox-option" for="whatsapp-available">
                                <input type="checkbox" id="whatsapp-available" checked>
                                <span class="checkbox-content">üì± Tambi√©n disponible en WhatsApp</span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Ubicaci√≥n del servicio:</label>
                        <button type="button" id="change-location-btn" class="change-location-btn">üìç Cambiar ubicaci√≥n</button>
                    </div>
                    <div class="form-group">
                        <label for="service-address">Direcci√≥n del servicio:</label>
                        <input type="text" id="service-address" required placeholder="Ingresa la direcci√≥n...">
                    </div>
                    <button type="submit" class="submit-btn">Publicar Servicio</button>
                </form>
            </div>
        </aside>

        <!-- Panel de Detalles de Servicio -->
        <aside id="detail-panel" class="detail-panel">
            <div class="panel-content">
                <div class="panel-header">
                    <h2>Detalles del Servicio</h2>
                    <button id="close-detail-panel" class="close-btn">&times;</button>
                </div>
                <div id="service-detail-content" class="service-detail-content">
                    <!-- Contenido din√°mico del servicio -->
                </div>
            </div>
        </aside>

        <!-- Modal de Autenticaci√≥n -->
        <section id="profile-modal" class="modal hidden-section">
            <div class="modal-content auth-modal">
                <button id="close-profile-modal" class="close-btn">&times;</button>
                
                <!-- Usuario NO autenticado: Login/Registro -->
                <div id="auth-section" class="auth-section">
                    <!-- Tabs de navegaci√≥n -->
                    <div class="auth-tabs">
                        <button class="auth-tab active" data-tab="login">Iniciar Sesi√≥n</button>
                        <button class="auth-tab" data-tab="register">Crear Cuenta</button>
                    </div>

                    <!-- Formulario de Login -->
                    <div id="login-tab-content" class="auth-tab-content active">
                        <h2 class="auth-title">Bienvenido de vuelta</h2>
                        <p class="auth-subtitle">Ingresa a tu cuenta para publicar y gestionar tus servicios</p>
                        
                        <form id="login-form" class="auth-form">
                            <div class="form-group">
                                <label for="login-email">Correo electr√≥nico</label>
                                <input 
                                    type="email" 
                                    id="login-email" 
                                    required 
                                    placeholder="tu@email.com"
                                    autocomplete="email">
                            </div>
                            
                            <div class="form-group">
                                <label for="login-password">Contrase√±a</label>
                                <input 
                                    type="password" 
                                    id="login-password" 
                                    required 
                                    placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                                    autocomplete="current-password"
                                    minlength="6">
                            </div>
                            
                            <div id="login-error" class="error-message hidden"></div>
                            
                            <button type="submit" class="submit-btn auth-submit-btn">
                                Iniciar Sesi√≥n
                            </button>
                        </form>
                    </div>

                    <!-- Formulario de Registro -->
                    <div id="register-tab-content" class="auth-tab-content">
                        <h2 class="auth-title">Crea tu cuenta</h2>
                        <p class="auth-subtitle">√önete y comienza a publicar tus servicios</p>
                        
                        <form id="signup-form" class="auth-form">
                            <div class="form-group">
                                <label for="register-name">Nombre completo</label>
                                <input 
                                    type="text" 
                                    id="register-name" 
                                    required 
                                    placeholder="Juan P√©rez"
                                    autocomplete="name">
                            </div>
                            
                            <div class="form-group">
                                <label for="register-email">Correo electr√≥nico</label>
                                <input 
                                    type="email" 
                                    id="register-email" 
                                    required 
                                    placeholder="tu@email.com"
                                    autocomplete="email">
                            </div>
                            
                            <div class="form-group">
                                <label for="register-phone">Tel√©fono (opcional)</label>
                                <input 
                                    type="tel" 
                                    id="register-phone" 
                                    placeholder="+56912345678"
                                    autocomplete="tel">
                                <small class="form-hint">Incluye c√≥digo de pa√≠s. Ej: +56912345678</small>
                            </div>
                            
                            <div class="form-group">
                                <label for="register-password">Contrase√±a</label>
                                <input 
                                    type="password" 
                                    id="register-password" 
                                    required 
                                    placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                                    autocomplete="new-password"
                                    minlength="6">
                                <small class="form-hint">M√≠nimo 6 caracteres</small>
                            </div>
                            
                            <div class="form-group">
                                <label for="register-password-confirm">Confirmar contrase√±a</label>
                                <input 
                                    type="password" 
                                    id="register-password-confirm" 
                                    required 
                                    placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                                    autocomplete="new-password"
                                    minlength="6">
                            </div>
                            
                            <div id="register-error" class="error-message hidden"></div>
                            
                            <button type="submit" class="submit-btn auth-submit-btn">
                                Crear Cuenta
                            </button>
                        </form>
                    </div>
                </div>

                <!-- Usuario autenticado: Men√∫ de perfil -->
                <div id="user-menu-section" class="user-menu-section hidden">
                    <div class="user-header">
                        <div class="user-avatar">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 2c5.52 0 10 4.48 10 10s-4.48 10-10 10S2 17.52 2 12 6.48 2 12 2zm0 4c-1.93 0-3.5 1.57-3.5 3.5S10.07 13 12 13s3.5-1.57 3.5-3.5S13.93 6 12 6zm0 14c-2.03 0-4.43-.82-6.14-2.88a9.947 9.947 0 0 1 12.28 0C16.43 19.18 14.03 20 12 20z"/>
                            </svg>
                        </div>
                        <div class="user-info">
                            <h3 id="user-display-name">Usuario</h3>
                            <p id="user-display-email">email@ejemplo.com</p>
                        </div>
                    </div>
                    
                    <div class="menu-options">
                        <button id="btn-my-services" class="menu-option">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon-svg">
                                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                                <line x1="9" y1="9" x2="15" y2="9"></line>
                                <line x1="9" y1="15" x2="15" y2="15"></line>
                            </svg>
                            <span>Mis Servicios</span>
                        </button>
                        <button id="btn-edit-profile" class="menu-option">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon-svg">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                <circle cx="12" cy="7" r="4"></circle>
                            </svg>
                            <span>Editar Perfil</span>
                        </button>
                        <button id="btn-pro-plan" class="menu-option pro-plan-option">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon-svg">
                                <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
                            </svg>
                            <span>Plan Pro</span>
                        </button>
                        <button id="btn-logout" class="menu-option logout-option">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon-svg">
                                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                                <polyline points="16 17 21 12 16 7"></polyline>
                                <line x1="21" y1="12" x2="9" y2="12"></line>
                            </svg>
                            <span>Cerrar Sesi√≥n</span>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Modal de Mis Servicios -->
        <section id="my-services-modal" class="modal hidden-section">
            <div class="modal-content my-services-modal">
                <div class="modal-header">
                    <button id="back-my-services" class="back-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="19" y1="12" x2="5" y2="12"></line>
                            <polyline points="12 19 5 12 12 5"></polyline>
                        </svg>
                        <span>Volver</span>
                    </button>
                    <h2 class="modal-title">Mis Servicios</h2>
                    <button id="close-my-services-modal" class="close-btn">&times;</button>
                </div>
                <div id="my-services-list" class="my-services-list">
                    <!-- Contenido din√°mico -->
                </div>
            </div>
        </section>

        <!-- Modal de Editar Perfil -->
        <section id="edit-profile-modal" class="modal hidden-section">
            <div class="modal-content edit-profile-modal">
                <div class="modal-header">
                    <button id="back-edit-profile" class="back-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="19" y1="12" x2="5" y2="12"></line>
                            <polyline points="12 19 5 12 12 5"></polyline>
                        </svg>
                        <span>Volver</span>
                    </button>
                    <h2 class="modal-title">Editar Perfil</h2>
                    <button id="close-edit-profile-modal" class="close-btn">&times;</button>
                </div>
                <form id="edit-profile-form" class="edit-profile-form">
                    <div class="form-group">
                        <label for="edit-name">Nombre completo</label>
                        <input type="text" id="edit-name" name="full_name" required minlength="2" maxlength="100" autocomplete="name">
                        <small class="form-hint">Tu nombre ser√° visible en tus servicios</small>
                    </div>

                    <div class="form-group">
                        <label for="edit-email">Email</label>
                        <input type="email" id="edit-email" name="email" required autocomplete="email">
                        <small class="form-hint">Usar√°s este email para iniciar sesi√≥n</small>
                    </div>

                    <div class="form-group">
                        <label for="edit-password">Nueva contrase√±a (opcional)</label>
                        <input type="password" id="edit-password" name="password" minlength="6" autocomplete="new-password">
                        <small class="form-hint">D√©jalo vac√≠o si no deseas cambiar tu contrase√±a</small>
                    </div>

                    <div class="form-group">
                        <label for="edit-password-confirm">Confirmar nueva contrase√±a</label>
                        <input type="password" id="edit-password-confirm" name="password_confirm" minlength="6" autocomplete="new-password">
                    </div>

                    <div class="form-actions">
                        <button type="button" id="cancel-edit-profile" class="btn-secondary">Cancelar</button>
                        <button type="submit" class="btn-primary">Guardar Cambios</button>
                    </div>
                </form>
            </div>
        </section>

        <!-- Modal de Plan Pro -->
        <section id="pro-plan-modal" class="modal hidden-section">
            <div class="modal-content pro-plan-modal">
                <div class="modal-header">
                    <button id="back-pro-plan" class="back-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="19" y1="12" x2="5" y2="12"></line>
                            <polyline points="12 19 5 12 12 5"></polyline>
                        </svg>
                        <span>Volver</span>
                    </button>
                    <h2 class="modal-title">Mejora a Pro</h2>
                    <button id="close-pro-plan-modal" class="close-btn">&times;</button>
                </div>
                <div class="pro-plan-content">
                    <div class="pro-plan-header">
                        <h3>Desbloquea tu Potencial</h3>
                        <p>Lleva tus servicios al siguiente nivel con los beneficios exclusivos del Plan Pro.</p>
                    </div>
                    <ul class="benefits-list">
                        <li>
                            <span class="benefit-icon">üöÄ</span>
                            <div class="benefit-text">
                                <h4>M√°s publicaciones por mes</h4>
                                <p>Publica m√°s servicios y aumenta tu visibilidad.</p>
                            </div>
                        </li>
                        <li>
                            <span class="benefit-icon">üìä</span>
                            <div class="benefit-text">
                                <h4>Anal√≠ticas Avanzadas</h4>
                                <p>Descubre cu√°ntos usuarios vieron tu perfil y te contactaron.</p>
                            </div>
                        </li>
                        <li>
                            <span class="benefit-icon">‚≠ê</span>
                            <div class="benefit-text">
                                <h4>Mejor Posicionamiento</h4>
                                <p>Aparece m√°s arriba en los resultados de b√∫squeda.</p>
                            </div>
                        </li>
                        <li>
                            <span class="benefit-icon">üëÄ</span>
                            <div class="benefit-text">
                                <h4>Visitantes del Perfil</h4>
                                <p>Recibe notificaciones de qui√©n ha visitado tu perfil.</p>
                            </div>
                        </li>
                        <li>
                            <span class="benefit-icon">üñºÔ∏è</span>
                            <div class="benefit-text">
                                <h4>Imagen de Portada</h4>
                                <p>Personaliza tu perfil con una imagen de portada √∫nica.</p>
                            </div>
                        </li>
                    </ul>
                    <div class="pro-plan-footer">
                        <button class="btn-primary btn-upgrade">Mejorar a Pro (Pr√≥ximamente)</button>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <div id="notification-container"></div>
    
    <!-- Modal de Confirmaci√≥n Moderno -->
    <div id="confirm-modal" class="confirm-modal hidden-section">
        <div class="confirm-modal-overlay"></div>
        <div class="confirm-modal-content">
            <div class="confirm-modal-icon">
                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="12" y1="8" x2="12" y2="12"></line>
                    <line x1="12" y1="16" x2="12.01" y2="16"></line>
                </svg>
            </div>
            <h3 class="confirm-modal-title" id="confirm-modal-title">¬øEst√°s seguro?</h3>
            <p class="confirm-modal-message" id="confirm-modal-message">Esta acci√≥n no se puede deshacer.</p>
            <div class="confirm-modal-actions">
                <button id="confirm-modal-cancel" class="confirm-btn confirm-btn-cancel">Cancelar</button>
                <button id="confirm-modal-confirm" class="confirm-btn confirm-btn-danger">Confirmar</button>
            </div>
        </div>
    </div>

    <!-- control-staging-area eliminado para evitar IDs duplicados -->

    <script>window.API_BASE_URL='https://proyecto-mapa.onrender.com/api/v1';</script>
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script type="module" src="js/main.js"></script>

    <!-- Panel de Fallback para Contacto por Correo -->
    <div id="email-fallback-panel" class="email-fallback-panel">
        <div class="fallback-header">
            <h4>Contacto por correo</h4>
            <button id="close-fallback-panel" class="close-fallback-btn">&times;</button>
        </div>
        <p class="fallback-email-display" id="fallback-email-text"></p>
        <div class="fallback-actions">
            <button id="fallback-copy-email" class="fallback-btn copy-btn">Copiar correo</button>
            <a id="fallback-open-gmail" href="#" target="_blank" class="fallback-btn gmail-btn">Abrir en Gmail</a>
        </div>
    </div>
</body>
</html>