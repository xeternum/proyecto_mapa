<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Geo-Red de Usuarios</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <link rel="stylesheet" href="styles.css">
</head>
<body>

    <header class="main-header">
        <div class="header-brand">
            <span class="logo-text">GeoRed</span>
        </div>
        <nav class="main-nav">
            <button id="btn-search-service" class="nav-btn nav-btn-search">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M18.031 16.617l4.283 4.282-1.415 1.415-4.282-4.283A8.96 8.96 0 0 1 11 20c-4.968 0-9-4.032-9-9s4.032-9 9-9 9 4.032 9 9a8.96 8.96 0 0 1-1.969 5.617zm-2.006-.742A6.977 6.977 0 0 0 18 11c0-3.868-3.133-7-7-7-3.868 0-7 3.132-7 7 0 3.867 3.132 7 7 7a6.977 6.977 0 0 0 4.875-1.975l.15-.15z"></path></svg>
                <span>Buscar</span>
            </button>
            <button id="btn-add-service" class="nav-btn">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M11 11V5h2v6h6v2h-6v6h-2v-6H5v-2h6z"></path></svg>
                <span>Publicar</span>
            </button>
            <button id="btn-profile-menu" class="nav-btn">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2c5.52 0 10 4.48 10 10s-4.48 10-10 10S2 17.52 2 12 6.48 2 12 2zm0 4c-1.93 0-3.5 1.57-3.5 3.5S10.07 13 12 13s3.5-1.57 3.5-3.5S13.93 6 12 6zm0 14c-2.03 0-4.43-.82-6.14-2.88a9.947 9.947 0 0 1 12.28 0C16.43 19.18 14.03 20 12 20z"></path></svg>
                <span>Perfil</span>
            </button>
        </nav>
    </header>

    <main>
        <!-- Secci贸n del Mapa (vista principal) -->
        <section id="map-section" class="active-section">
            <div id="map"></div>

            <!-- Hero overlay (mini-landing sobre el mapa) -->
            <div class="map-hero" role="region" aria-label="Introducci贸n">
                <h1 class="hero-title">Encuentra servicios locales</h1>
                <p class="hero-subtitle">Publica tu oferta en 1 minuto</p>
                <div class="hero-ctas">
                    <button id="hero-explore" class="cta-btn">Explorar mapa</button>
                    <button id="hero-publish" class="cta-btn secondary">Publicar servicio</button>
                </div>
            </div>

            <div class="floating-controls">
                <button id="btn-current-location" class="control-btn" title="Mostrar tu ubicacion">
                    <span></span>
                </button>
            </div>
        </section>

        <!-- Panel de B煤squeda de Servicios -->
        <aside id="search-panel" class="search-panel">
            <div class="panel-content">
                <div class="panel-header">
                    <h2>Buscar servicios cerca de m铆</h2>
                    <button id="close-search-panel" class="close-btn">&times;</button>
                </div>
                <div class="search-container">
                    <input type="text" id="service-search-input" placeholder="Buscar servicios..." class="search-input">
                    <div id="filter-status" class="filter-status"></div>
                    <div id="service-categories" class="categories-grid"></div>
                </div>
                <div id="search-results" class="results-container">
                    <div id="results-count"></div>
                    <ul id="nearby-users-list"></ul>
                </div>
            </div>
        </aside>

        <!-- Panel de Publicar Servicio -->
        <aside id="publish-panel" class="search-panel">
            <div class="panel-content">
                <div class="panel-header">
                    <h2>Publicar un servicio</h2>
                    <button id="close-publish-panel" class="close-btn">&times;</button>
                </div>
                <form id="register-form" class="publish-form">
                    <div class="form-group">
                        <label for="service-name">Nombre del servicio:</label>
                        <input type="text" id="service-name" required placeholder="Ej: Reparaci贸n de electrodom茅sticos">
                    </div>
                    <div class="form-group">
                        <label for="service-description">Descripci贸n del servicio:</label>
                        <textarea id="service-description" required placeholder="Describe tu servicio en detalle..." rows="3"></textarea>
                    </div>
                    
                    <!-- Sistema de Precios Mejorado -->
                    <div class="form-group">
                        <label for="service-price">Precio:</label>
                        <div class="price-input-group">
                            <span class="currency-symbol">$</span>
                            <input type="number" id="service-price" required placeholder="15000" min="0" step="100">
                        </div>
                        <small class="form-hint">Ingresa solo el monto num茅rico (sin puntos ni comas)</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="price-modality">Modalidad de cobro:</label>
                        <select id="price-modality" required>
                            <option value="por_servicio" selected>Por servicio completo</option>
                            <option value="por_hora">Por hora</option>
                            <option value="por_dia">Por d铆a</option>
                            <option value="por_mes">Por mes</option>
                            <option value="por_proyecto">Por proyecto</option>
                            <option value="consultar">A consultar</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="service-schedule">Horario de atenci贸n:</label>
                        <select id="service-schedule" required>
                            <option value="">Selecciona un horario</option>
                            <option value="Lunes a Viernes">Lunes a Viernes</option>
                            <option value="Lunes a S谩bado">Lunes a S谩bado</option>
                            <option value="Lunes a Domingo">Lunes a Domingo</option>
                            <option value="24 horas">24 horas</option>
                            <option value="Solo festivos">Solo festivos</option>
                        </select>
                    </div>
                    
                    <!-- Secci贸n de Contacto Mejorada -->
                    <div class="form-group">
                        <label>M茅todo de contacto preferido:</label>
                        <div class="contact-method-selector">
                            <label class="radio-button-option" for="contact-email">
                                <input type="radio" id="contact-email" name="contact-method" value="email" checked>
                                <span class="radio-button-content"> Email</span>
                            </label>
                            <label class="radio-button-option" for="contact-phone">
                                <input type="radio" id="contact-phone" name="contact-method" value="phone">
                                <span class="radio-button-content"> Tel茅fono m贸vil</span>
                            </label>
                        </div>
                    </div>

                    <!-- Email Contact Section -->
                    <div id="email-contact-section" class="contact-section">
                        <div class="form-group">
                            <label for="user-email">Email de contacto:</label>
                            <input type="email" id="user-email" value="contacto@ejemplo.com" placeholder="tu-email@ejemplo.com">
                            <small class="form-hint">Este email ser谩 visible solo para clientes interesados</small>
                        </div>
                    </div>

                    <!-- Phone Contact Section -->
                    <div id="phone-contact-section" class="contact-section hidden">
                        <div class="form-group">
                            <label for="user-phone">Tel茅fono m贸vil:</label>
                            <input type="tel" id="user-phone" value="+56912345678" placeholder="+56912345678" maxlength="20">
                            <small class="form-hint">Incluye c贸digo de pa铆s. Ej: +56912345678, +34612345678</small>
                            <div id="phone-validation" class="validation-message"></div>
                        </div>
                        
                        <div class="form-group">
                            <label class="checkbox-option" for="whatsapp-available">
                                <input type="checkbox" id="whatsapp-available" checked>
                                <span class="checkbox-content"> Tambi茅n disponible en WhatsApp</span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Ubicaci贸n del servicio:</label>
                        <button type="button" id="change-location-btn" class="change-location-btn"> Cambiar ubicaci贸n</button>
                    </div>
                    <div class="form-group">
                        <label for="service-address">Direcci贸n del servicio:</label>
                        <input type="text" id="service-address" required placeholder="Ingresa la direcci贸n...">
                    </div>
                    <div class="form-group">
                        <label for="service-main-category">Categor铆a principal:</label>
                        <select id="service-main-category" required>
                            <option value="">Selecciona una categor铆a</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="service-subcategory">Servicio espec铆fico:</label>
                        <select id="service-subcategory" required>
                            <option value="">Selecciona un servicio</option>
                        </select>
                    </div>
                    <button type="submit" class="submit-btn">Publicar Servicio</button>
                </form>
            </div>
        </aside>

        <!-- Panel de Detalles de Servicio -->
        <aside id="detail-panel" class="detail-panel">
            <div class="panel-content">
                <div class="panel-header">
                    <h2>Detalles del Servicio</h2>
                    <button id="close-detail-panel" class="close-btn">&times;</button>
                </div>
                <div id="service-detail-content" class="service-detail-content">
                    <!-- Contenido din谩mico del servicio -->
                </div>
            </div>
        </aside>

        <!-- Modal de Men煤/Perfil -->
        <section id="profile-modal" class="modal hidden-section">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Men煤</h2>
                    <button id="close-profile-modal" class="close-btn">&times;</button>
                </div>
                <div class="menu-options">
                    <button id="btn-my-profile" class="menu-option">
                        <span class="icon"></span>
                        <span>Mi Perfil</span>
                    </button>
                    <button id="btn-settings" class="menu-option">
                        <span class="icon"></span>
                        <span>Configuraci贸n</span>
                    </button>
                </div>
            </div>
        </section>

    </main>

    <div id="notification-container"></div>

    <!-- control-staging-area eliminado para evitar IDs duplicados -->
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script type="module" src="js/main.js"></script>
</body>
</html>